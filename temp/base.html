<!DOCTYPE html>
<html lang="zh-cn">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>herald doc</title>

    <!-- Bootstrap -->
    <link rel="stylesheet" href="http://cdn.bootcss.com/bootstrap/3.3.0/css/bootstrap.min.css">
    <link rel="stylesheet" href="{{static_url("css/herald.css")}}">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="http://cdn.bootcss.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="http://cdn.bootcss.com/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
    <nav class="navbar navbar-default " role="navigation">
      <div class="container-fluid">
        <div class="navbar-header">
          <a class="navbar-brand" href="#">
            <img alt="Brand" src="{{ static_url("images/recover-doc-file.png")}}" width="28" height="28">
          </a>
        <form class="navbar-form navbar-left" role="search">
            <div class="form-group">
              <input type="text" class="form-control" placeholder="Search" width="400">
            </div>
            <button type="submit" class="btn btn-default">Submit</button>
        </form>
        </div>
        <ul class="nav navbar-nav navbar-right">
            {% if user == None %}
                <li><button type="button" class="btn btn-primary navbar-btn" data-toggle="modal" data-target="#login">登陆</button></li>
                <li><button type="button" class="btn btn-primary navbar-btn" data-toggle="modal" data-target="#register">注册</button></li>
            {% end %}
            {% if user is not None %}
                <li><p class="navbar-text">欢迎你<a href="#">{{ current_user }}</a></p></li>
                <li><a class="navbar-brand" href="/upload">上传文件</button></li>
                <li><a class="navbar-brand" href="/logout">logout</a></li>
            {% end %}
        </ul>
      </div>
    </nav>
    <div class="modal fade" id="login" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            <h4 class="modal-title" id="myModalLabel">登陆</h4>
          </div>
          <div class="modal-body">
            <form role="form" action="/login">
               <div class="form-group">
                  <label for="name">用户名</label>
                  <input type="text" class="form-control" id="username" 
                     placeholder="请输入用户名">
               </div>
               <div class="form-group">
                  <label for="name">密码</label>
                  <input type="password" class="form-control" id="password" 
                     placeholder="请输入密码">
               </div>
            </form>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            <button id="loginbtn" class="btn btn-primary" data-loading-text="Loading..." type="button"> 加载状态</button>
          </div>
        </div>
      </div>
    </div>
    <div class="modal fade" id="register" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            <h4 class="modal-title" id="myModalLabel">注册</h4>
          </div>
          <div class="modal-body">
            <form role="form">
               <div class="form-group">
                  <label for="name">用户名</label>
                  <input type="text" class="form-control" id="regusername" 
                     placeholder="请输入用户名">
               </div>
               <div class="form-group">
                  <label for="name">密码</label>
                  <input type="password" class="form-control" id="regpassword" 
                     placeholder="请输入密码">
               </div>
               <div class="form-group">
                  <label for="name">再次输入密码</label>
                  <input type="password" class="form-control" id="reregpassword" 
                     placeholder="再次输入密码">
               </div>
            </form>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            <button id="loginbtn" class="btn btn-primary" data-loading-text="Loading..." type="button"> 加载状态</button>
          </div>
        </div>
      </div>
    </div>
    {% block container %}
    {% end %}
    <!-- jQuery文件。务必在bootstrap.min.js 之前引入 -->
    <script src="http://cdn.bootcss.com/jquery/1.11.1/jquery.min.js"></script>
    <!-- 最新的 Bootstrap 核心 JavaScript 文件 -->
    <script src="http://cdn.bootcss.com/bootstrap/3.3.0/js/bootstrap.min.js"></script>
    <script type="text/javascript">
    $(document).ready(function(){
      $("#loginbtn").click(function(){
            $.post("/login",
            {
                username:$("#username").val(),
                password:$("#password").val()
            },
            function(data,status){
                if(data =="-1"){
                    $("#loginbtn").button('reset');
                    alert("password error ,please check your input");
                }

                else{
                    $("#loginbtn").button('reset');
                    $('#login').modal('hide');
                    location.href ="/";
                }
            });
        });  
    });
    </script>
  </body>
</html>